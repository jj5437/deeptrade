# ç­–ç•¥ä¼˜åŒ–æ–¹æ¡ˆ

## å½“å‰çŠ¶æ€ï¼ˆBaselineï¼‰

### æ ¸å¿ƒæ•°æ®
- äº¤æ˜“æ¬¡æ•°: 202ç¬”
- èƒœç‡: 28.22%
- ç›ˆäºæ¯”: 1.97
- å¹´åŒ–æ”¶ç›Š: -37.08%
- æœ€å¤§å›æ’¤: 25.25%

### åˆ†å¸‚åœºè¡¨ç°
| å¸‚åœº | æ”¶ç›Š | èƒœç‡ | äº¤æ˜“æ•° | è¯„ä»· |
|------|------|------|--------|------|
| ç†Šå¸‚2022 | +9.14% | 34.94% | 538 | âœ“ æœ‰æ•ˆ |
| ç‰›å¸‚2021 | -5.11% | 33.71% | 976 | âœ— å¤±æ•ˆ |
| éœ‡è¡2023H1 | -20.52% | 28.22% | 202 | âœ— æœ€å·® |

## ä¼˜åŒ–æ–¹å‘

### æ–¹æ¡ˆAï¼šè°ƒæ•´æ­¢æŸæ­¢ç›ˆï¼ˆæ¨èï¼‰

#### é—®é¢˜åˆ†æ
```
å½“å‰: SL=0.6%, TP=1.2% (1:2)
éœ‡è¡å¸‚ç‰¹ç‚¹: ä»·æ ¼åœ¨Â±0.5-0.8%æ³¢åŠ¨
ç»“æœ: æ­¢æŸé¢‘ç¹è§¦å‘ï¼Œæ­¢ç›ˆå¾ˆå°‘è¾¾åˆ°
```

#### ä¼˜åŒ–æ–¹æ¡ˆ
```javascript
// é€‰é¡¹1ï¼šæ‰©å¤§æ­¢æŸï¼Œä¿æŒç›ˆäºæ¯”
stopLoss: 1.0%,    // 0.6% -> 1.0%
takeProfit: 2.0%,  // 1.2% -> 2.0%
ç›ˆäºæ¯”: 2:1ï¼ˆä¿æŒï¼‰

// é€‰é¡¹2ï¼šç¼©å°ç›ˆäºæ¯”ï¼Œæé«˜èƒœç‡
stopLoss: 0.8%,    // 0.6% -> 0.8%
takeProfit: 1.2%,  // ä¿æŒ
ç›ˆäºæ¯”: 1.5:1

// é€‰é¡¹3ï¼šè‡ªé€‚åº”ï¼ˆæ ¹æ®å¸‚åœºæ³¢åŠ¨æ€§ï¼‰
ATR = å¹³å‡çœŸå®æ³¢å¹…
stopLoss: ATR * 2
takeProfit: ATR * 4
```

**é¢„æœŸæ•ˆæœ**ï¼š
- èƒœç‡: 28% -> 38-45%
- ç›ˆäºæ¯”: 1.97 -> 1.5-2.0
- æœŸæœ›å€¼: æ­£å€¼

#### å®æ–½ä»£ç 
åœ¨ `VolumeProfileStrategy.js` ç¬¬626è¡Œä¿®æ”¹ï¼š
```javascript
// å½“å‰ï¼ˆå›ºå®šï¼‰
const stopLossPercent = 0.006;
const takeProfitPercent = 0.012;

// ä¼˜åŒ–ï¼ˆæ–¹æ¡ˆ1ï¼‰
const stopLossPercent = 0.010;  // 1%
const takeProfitPercent = 0.020; // 2%
```

### æ–¹æ¡ˆBï¼šæ·»åŠ å¸‚åœºçŠ¶æ€è¿‡æ»¤

#### é—®é¢˜åˆ†æ
```
éœ‡è¡å¸‚: èƒœç‡28%ï¼Œå¤§å¹…äºæŸ
ç­–ç•¥åœ¨éœ‡è¡å¸‚é¢‘ç¹äº¤æ˜“ï¼Œæ•ˆç‡ä½
```

#### ä¼˜åŒ–æ–¹æ¡ˆ
åŠ å…¥è¶‹åŠ¿å¼ºåº¦è¿‡æ»¤å™¨ï¼š

```javascript
// è®¡ç®—è¶‹åŠ¿å¼ºåº¦ï¼ˆADXæˆ–EMAæ–œç‡ï¼‰
function getTrendStrength(klines) {
  const ema20 = calculateEMA(klines, 20);
  const ema50 = calculateEMA(klines, 50);
  const ema100 = calculateEMA(klines, 100);
  
  // è¶‹åŠ¿æ˜ç¡®
  if (ema20 > ema50 && ema50 > ema100) {
    return 'UPTREND';  // åªåšå¤š
  } else if (ema20 < ema50 && ema50 < ema100) {
    return 'DOWNTREND';  // åªåšç©º
  } else {
    return 'RANGING';  // éœ‡è¡å¸‚ï¼Œé™ä½äº¤æ˜“é¢‘ç‡æˆ–è·³è¿‡
  }
}

// åœ¨ç­–ç•¥ä¸­åº”ç”¨
if (marketState === 'RANGING') {
  // éœ‡è¡å¸‚ï¼šæé«˜é˜ˆå€¼æˆ–è·³è¿‡
  minScoreRequired *= 1.5;
}
```

**é¢„æœŸæ•ˆæœ**ï¼š
- éœ‡è¡å¸‚äº¤æ˜“æ•°: 202 -> 50-80ï¼ˆå‡å°‘70%ï¼‰
- éœ‡è¡å¸‚èƒœç‡: 28% -> 35-40%
- æ•´ä½“èƒœç‡: æå‡5-10%

### æ–¹æ¡ˆCï¼šä¼˜åŒ–å…¥åœºæ—¶æœº

#### é—®é¢˜åˆ†æ
```
å½“å‰: è¾¹æ²¿è§¦å‘ + æˆäº¤é‡çˆ†å‘ -> ç«‹å³å…¥åœº
é—®é¢˜: å¯èƒ½æ˜¯å‡çªç ´
```

#### ä¼˜åŒ–æ–¹æ¡ˆ
æ·»åŠ ç¡®è®¤æœºåˆ¶ï¼š

```javascript
// ç­‰å¾…ä¸‹ä¸€æ ¹Kçº¿ç¡®è®¤
if (signal === 'BUY') {
  // ç¡®è®¤ï¼šä¸‹ä¸€æ ¹Kçº¿æ”¶ç›˜ä»· > å½“å‰Kçº¿æœ€é«˜ä»·
  waitForConfirmation = true;
}

// æˆ–ï¼šä½¿ç”¨æ›´å°çš„ä»“ä½è¯•æ¢
if (confidence === 'MEDIUM') {
  positionSize *= 0.5;  // å‡åŠä»“ä½
}
```

**é¢„æœŸæ•ˆæœ**ï¼š
- äº¤æ˜“æ•°: 202 -> 150ï¼ˆå‡å°‘25%ï¼‰
- èƒœç‡: 28% -> 35-40%ï¼ˆè¿‡æ»¤å‡çªç ´ï¼‰
- æ•´ä½“æ”¶ç›Š: æ”¹å–„

### æ–¹æ¡ˆDï¼šåŠ¨æ€ä»“ä½ç®¡ç†

#### é—®é¢˜åˆ†æ
```
å½“å‰: å›ºå®šä»“ä½$1000
é—®é¢˜: ä¸åŒºåˆ†ä¿¡å·è´¨é‡
```

#### ä¼˜åŒ–æ–¹æ¡ˆ
æ ¹æ®ä¿¡å·å¼ºåº¦è°ƒæ•´ä»“ä½ï¼š

```javascript
function calculatePositionSize(baseSize, confidence, finalScore) {
  if (confidence === 'HIGH' && finalScore > 0.65) {
    return baseSize * 1.5;  // å¼ºä¿¡å·ï¼š150%ä»“ä½
  } else if (confidence === 'MEDIUM' && finalScore > 0.55) {
    return baseSize * 1.0;  // ä¸­ç­‰ä¿¡å·ï¼š100%ä»“ä½
  } else {
    return baseSize * 0.5;  // å¼±ä¿¡å·ï¼š50%ä»“ä½
  }
}
```

**é¢„æœŸæ•ˆæœ**ï¼š
- æé«˜å¼ºä¿¡å·çš„ç›ˆåˆ©
- é™ä½å¼±ä¿¡å·çš„äºæŸ
- æ•´ä½“æ”¶ç›Šæ”¹å–„

## ä¼˜å…ˆçº§æ¨è

### Phase 1ï¼šå¿«é€Ÿä¼˜åŒ–ï¼ˆç«‹å³å®æ–½ï¼‰

**1. è°ƒæ•´æ­¢æŸæ­¢ç›ˆï¼ˆæœ€é‡è¦ï¼‰**
```javascript
// backend/src/backtest/BacktestEngine.js ç¬¬22-23è¡Œ
this.stopLossPct = 0.010;  // 0.6% -> 1.0%
this.takeProfitPct = 0.020; // 1.2% -> 2.0%
```

**é¢„æœŸæ”¹å–„**ï¼š
- èƒœç‡: 28% -> 35-40%
- å¹´åŒ–æ”¶ç›Š: -37% -> 0-15%

### Phase 2ï¼šä¸­æœŸä¼˜åŒ–ï¼ˆéœ€è¦å¼€å‘ï¼‰

**2. æ·»åŠ è¶‹åŠ¿è¿‡æ»¤å™¨**
- å®æ–½æ—¶é—´: 2-4å°æ—¶
- é¢„æœŸæ”¹å–„: èƒœç‡ +5-8%

**3. éœ‡è¡å¸‚è¯†åˆ«**
- åœ¨éœ‡è¡å¸‚é™ä½äº¤æ˜“é¢‘ç‡
- é¢„æœŸæ”¹å–„: å›æ’¤ -10%

### Phase 3ï¼šé•¿æœŸä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

**4. æœºå™¨å­¦ä¹ å‚æ•°ä¼˜åŒ–**
- ä½¿ç”¨é—ä¼ ç®—æ³•ä¼˜åŒ–å‚æ•°
- é¢„æœŸæ”¹å–„: æ•´ä½“æ€§èƒ½ +20%

**5. å¤šç­–ç•¥ç»„åˆ**
- å¼€å‘ç¬¬äºŒä¸ªç­–ç•¥ï¼ˆè¶‹åŠ¿è·Ÿè¸ªï¼‰
- ç­–ç•¥Aï¼ˆå½“å‰ï¼‰+ ç­–ç•¥B
- é¢„æœŸæ”¹å–„: å¤æ™®æ¯”ç‡ > 2.0

## å®æ–½æ­¥éª¤

### Step 1: è°ƒæ•´æ­¢æŸæ­¢ç›ˆï¼ˆ5åˆ†é’Ÿï¼‰

ä¿®æ”¹æ–‡ä»¶ï¼š`backend/src/backtest/BacktestEngine.js`

```javascript
// ç¬¬22-23è¡Œ
this.stopLossPct = config.stopLossPct || 0.010;    // 1.0%
this.takeProfitPct = config.takeProfitPct || 0.020; // 2.0%
```

è¿è¡Œï¼š
```bash
npm run backtest
```

è§‚å¯Ÿï¼š
- èƒœç‡æ˜¯å¦æå‡åˆ°35%+ï¼Ÿ
- å¹´åŒ–æ”¶ç›Šæ˜¯å¦è½¬æ­£ï¼Ÿ

### Step 2: å¦‚æœæ•ˆæœä¸ä½³ï¼Œå°è¯•æ–¹æ¡ˆ2

```javascript
this.stopLossPct = 0.008;  // 0.8%
this.takeProfitPct = 0.012; // 1.2%ï¼ˆä¿æŒï¼‰
```

### Step 3: è®°å½•å¹¶æ¯”è¾ƒ

| é…ç½® | èƒœç‡ | ç›ˆäºæ¯” | å¹´åŒ–æ”¶ç›Š | æœ€ä¼˜ï¼Ÿ |
|------|------|--------|----------|--------|
| 0.6%/1.2% | 28% | 1.97 | -37% | âœ— |
| 1.0%/2.0% | ? | ? | ? | ? |
| 0.8%/1.2% | ? | ? | ? | ? |

## ç†è®ºåˆ†æ

### ç›ˆäºæ¯”ä¸èƒœç‡çš„å…³ç³»

```
æœŸæœ›å€¼ = èƒœç‡ Ã— ç›ˆåˆ© - è´¥ç‡ Ã— äºæŸ

ç›ˆäºæ¯”2:1ï¼Œéœ€è¦èƒœç‡ > 33.3%
ç›ˆäºæ¯”1.5:1ï¼Œéœ€è¦èƒœç‡ > 40%
ç›ˆäºæ¯”1:1ï¼Œéœ€è¦èƒœç‡ > 50%

å½“å‰ç­–ç•¥ï¼š
- ç›ˆäºæ¯” 1.97ï¼Œéœ€è¦èƒœç‡ > 33.7%
- å®é™…èƒœç‡ 28.2%
- å·®è·: -5.5%

å¦‚æœæé«˜åˆ°èƒœç‡35%ï¼š
æœŸæœ›å€¼ = 0.35 Ã— 1.97 - 0.65 Ã— 1 = 0.04ï¼ˆç›ˆåˆ©ï¼‰

å¦‚æœæé«˜åˆ°èƒœç‡40%ï¼š
æœŸæœ›å€¼ = 0.40 Ã— 1.97 - 0.60 Ã— 1 = 0.19ï¼ˆæ˜¾è‘—ç›ˆåˆ©ï¼‰
```

### æ­¢æŸæ­¢ç›ˆçš„å½±å“

```
å½“å‰é…ç½®ï¼ˆ0.6%/1.2%ï¼‰ï¼š
- ä¼˜ç‚¹ï¼šç›ˆäºæ¯”é«˜ï¼ˆ2:1ï¼‰
- ç¼ºç‚¹ï¼šæ­¢æŸå¤ªç´§ï¼Œå®¹æ˜“è¢«æ‰“

æ”¾å®½é…ç½®ï¼ˆ1.0%/2.0%ï¼‰ï¼š
- ä¼˜ç‚¹ï¼šç»™ä»·æ ¼æ›´å¤šæ³¢åŠ¨ç©ºé—´
- ç¼ºç‚¹ï¼šå•ç¬”äºæŸå¢åŠ ï¼Œéœ€è¦æ›´é«˜èƒœç‡

å¹³è¡¡é…ç½®ï¼ˆ0.8%/1.5%ï¼‰ï¼š
- ç›ˆäºæ¯”é™åˆ°1.9:1
- èƒœç‡å¯èƒ½æå‡åˆ°35-40%
- æ•´ä½“æœŸæœ›å€¼æ”¹å–„
```

## é£é™©æç¤º

### è¿‡åº¦æ‹Ÿåˆé£é™©
- ä¸è¦åŸºäºå•ä¸€æ—¶é—´æ®µä¼˜åŒ–å‚æ•°
- ç¡®ä¿åœ¨æ‰€æœ‰å¸‚åœºçŠ¶æ€ä¸‹æµ‹è¯•
- ç•™å‡ºæ ·æœ¬å¤–æ•°æ®éªŒè¯

### å›æ’¤ç®¡ç†
- å½“å‰æœ€å¤§å›æ’¤25%åé«˜
- ç›®æ ‡ï¼šæ§åˆ¶åœ¨15%ä»¥å†…
- æ–¹æ³•ï¼šé™ä½å•ç¬”é£é™©æˆ–å‡å°‘äº¤æ˜“é¢‘ç‡

### ç­–ç•¥è¡°å‡
- é‡åŒ–ç­–ç•¥æœ‰ç”Ÿå‘½å‘¨æœŸ
- éœ€è¦å®šæœŸå›æµ‹å’Œè°ƒæ•´
- å»ºç«‹ç›‘æ§ç³»ç»Ÿ

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. âœ… **ç«‹å³**: ä¿®æ”¹æ­¢æŸæ­¢ç›ˆåˆ°1.0%/2.0%
2. ğŸ”„ **è¿è¡Œ**: é‡æ–°å›æµ‹
3. ğŸ“Š **åˆ†æ**: æ¯”è¾ƒç»“æœ
4. âš™ï¸ **å¾®è°ƒ**: å¦‚æœéœ€è¦ï¼Œç»§ç»­ä¼˜åŒ–
5. âœ… **éªŒè¯**: åœ¨ä¸åŒå¸‚åœºå‘¨æœŸæµ‹è¯•

---

**ç›®æ ‡**ï¼š
- èƒœç‡ > 35%
- å¹´åŒ–æ”¶ç›Š > 15%
- æœ€å¤§å›æ’¤ < 15%
- å¤æ™®æ¯”ç‡ > 1.5

