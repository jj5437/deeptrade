# æˆäº¤é‡åŠ¨æ€æ­£æ€åˆ†å¸ƒç­–ç•¥å®žæ–½æ–‡æ¡£

## æ¦‚è¿°

æœ¬ç­–ç•¥åŸºäºŽ `norm_policy.txt` å®žçŽ°ï¼Œé‡‡ç”¨"æ··åˆæ™ºèƒ½ç³»ç»Ÿ"æž¶æž„ï¼š
- **è®¡ç®—é€»è¾‘å±‚**ï¼šæˆäº¤é‡åˆ†æžç­–ç•¥ï¼ˆæ¨¡å—A-Dï¼‰
- **AIå†³ç­–å±‚**ï¼šDeepSeek AI é£ŽæŽ§å®¡æŸ¥

## å‚æ•°è°ƒæ•´è¯´æ˜Žï¼ˆ2åˆ†é’Ÿ â†’ 3åˆ†é’ŸKçº¿ï¼‰

ç”±äºŽå¸å®‰WebSocket APIä¸æ”¯æŒ2åˆ†é’ŸKçº¿ï¼Œä»…æ”¯æŒ1åˆ†é’Ÿå’Œ3åˆ†é’Ÿï¼Œæˆ‘ä»¬é€‰æ‹©**3åˆ†é’ŸKçº¿**ä½œä¸ºå®žæ–½å‘¨æœŸã€‚

### è°ƒæ•´åŽŸç†

3åˆ†é’ŸKçº¿ç›¸æ¯”2åˆ†é’Ÿï¼š
- æ—¶é—´è·¨åº¦å¢žåŠ  50%
- æˆäº¤é‡èšåˆæ›´å¤šï¼Œæ³¢åŠ¨ç›¸å¯¹è¾ƒå°
- éœ€è¦é€‚å½“é™ä½Žæ•æ„Ÿåº¦é˜ˆå€¼ä»¥ä¿æŒç­–ç•¥æœ‰æ•ˆæ€§

### å…·ä½“å‚æ•°è°ƒæ•´

| å‚æ•° | åŽŸå€¼(2åˆ†é’Ÿ) | æ–°å€¼(3åˆ†é’Ÿ) | è°ƒæ•´æ¯”ä¾‹ | è¯´æ˜Ž |
|------|------------|------------|---------|------|
| Kçº¿æ•°é‡ | 720æ ¹ | 720æ ¹ | ä¸å˜ | ä¿æŒ36å°æ—¶åŽ†å²æ•°æ® |
| çª—å£é˜ˆå€¼ | 30%å³°å€¼ | 30%å³°å€¼ | ä¸å˜ | ä¿æŒçª—å£è¯†åˆ«ä¸€è‡´æ€§ |
| è¾¹æ²¿èŒƒå›´ | å‰åŽ3æ ¹ | å‰åŽ4æ ¹ | +33% | é€‚åº”æ›´é•¿æ—¶é—´å‘¨æœŸ |
| ä»·å€¼åŒº | 70%æˆäº¤é‡ | 70%æˆäº¤é‡ | ä¸å˜ | ä¿æŒæ ¸å¿ƒå®šä¹‰ |

#### æ¨¡å—Bå‚æ•°ï¼ˆæˆäº¤é‡çˆ†å‘æ£€æµ‹ï¼‰

| å‚æ•° | åŽŸå€¼ | æ–°å€¼ | è°ƒæ•´ç†ç”± |
|------|------|------|---------|
| P1_WEIGHT | 0.25 | 0.25 | ä¸å˜ï¼ˆä½ç½®åˆ¤æ–­ï¼‰ |
| P2_LOCAL_Z | 2.3 | 2.3 | ä¸å˜ï¼ˆå±€éƒ¨æ ‡å‡†å·®ï¼‰ |
| P3_GLOBAL_Z | 2.0 | 2.0 | ä¸å˜ï¼ˆå…¨å±€æ ‡å‡†å·®ï¼‰ |
| P4_VOLUME_RATIO | 2.2 | **2.0** | -9% - 3åˆ†é’Ÿæ³¢åŠ¨æ›´å¤§ |
| P5_MA5_RATIO | 1.9 | **1.8** | -5% - åŒç†é™ä½Žæ•æ„Ÿåº¦ |
| P6_DIST_STRENGTH | 1.3 | 1.3 | ä¸å˜ |
| P7_CONTINUATION | 0.6 | 0.6 | ä¸å˜ |

#### æ¨¡å—Cå‚æ•°ï¼ˆå¸‚åœºæ¡ä»¶éªŒè¯ï¼‰

| å‚æ•° | åŽŸå€¼ | æ–°å€¼ | è°ƒæ•´ç†ç”± |
|------|------|------|---------|
| ORDERBOOK_RATIO_LONG | 2.8 | 2.8 | ä¸å˜ï¼ˆè®¢å•ç°¿æ¯”çŽ‡ï¼‰ |
| ORDERBOOK_RATIO_SHORT | 0.35 | 0.35 | ä¸å˜ |
| DELTA_THRESHOLD_LONG | 800 | **1200** | +50% - æŒ‰æ—¶é—´å‘¨æœŸè°ƒæ•´ |
| DELTA_THRESHOLD_SHORT | -800 | **-1200** | +50% - åŒä¸Š |
| FUNDING_RATE_LONG | -0.0001 | -0.0001 | ä¸å˜ |
| FUNDING_RATE_SHORT | 0.0003 | 0.0003 | ä¸å˜ |

#### æ¨¡å—Då‚æ•°ï¼ˆå†³ç­–èžåˆï¼‰

| å‚æ•° | åŽŸå€¼ | æ–°å€¼ | è¯´æ˜Ž |
|------|------|------|------|
| SCORE_B_STRONG | 0.80 | 0.80 | å¼ºä¿¡å·é˜ˆå€¼ |
| SCORE_C_STRONG | 0.75 | 0.75 | å¼ºéªŒè¯é˜ˆå€¼ |
| SCORE_C_LIGHT | 0.50 | 0.50 | è½»éªŒè¯é˜ˆå€¼ |
| FINAL_SCORE_THRESHOLD | 0.78 | 0.78 | æœ€ç»ˆå†³ç­–é˜ˆå€¼ |
| WEIGHT_B | 0.6 | 0.6 | æˆäº¤é‡æƒé‡ |
| WEIGHT_C | 0.4 | 0.4 | å¸‚åœºæƒé‡ |

## ç­–ç•¥å·¥ä½œæµç¨‹

```mermaid
graph TD
    A[å¸‚åœºæ•°æ®] --> B[æ¨¡å—A: è®¡ç®—æˆäº¤é‡åˆ†å¸ƒ]
    B --> C{åœ¨è¾¹æ²¿åŒºåŸŸ?}
    C -->|å¦| D[è¿”å›žHOLD]
    C -->|æ˜¯| E[æ¨¡å—B: æ£€æµ‹æˆäº¤é‡çˆ†å‘]
    E --> F{ScoreB > 0.25?}
    F -->|å¦| D
    F -->|æ˜¯| G[æ¨¡å—C: éªŒè¯å¸‚åœºæ¡ä»¶]
    G --> H[æ¨¡å—D: è®¡ç®—æœ€ç»ˆåˆ†æ•°]
    H --> I{FinalScore >= 0.78?}
    I -->|å¦| D
    I -->|æ˜¯| J[ç”Ÿæˆäº¤æ˜“ä¿¡å·]
    J --> K[AIé£ŽæŽ§å®¡æŸ¥]
    K --> L{AIæ‰¹å‡†?}
    L -->|å¦| D
    L -->|æ˜¯| M[æ‰§è¡Œäº¤æ˜“]
```

## æ­¢æŸæ­¢ç›ˆè®¾ç½®

åŸºäºŽ AlphaArena é£ŽæŽ§åŽŸåˆ™ï¼š
- **æ­¢æŸ (SL)**: 0.6% - ä¸¥æ ¼é£ŽæŽ§
- **æ­¢ç›ˆ (TP)**: 1.2% - ä¿æŒ2:1é£ŽæŠ¥æ¯”
- **æ æ†**: 10x

è®¡ç®—å…¬å¼ï¼š
```javascript
// åšå¤š
stopLoss = currentPrice * (1 - 0.006)
takeProfit = currentPrice * (1 + 0.012)

// åšç©º
stopLoss = currentPrice * (1 + 0.006)
takeProfit = currentPrice * (1 - 0.012)
```

## AIé£ŽæŽ§å®¡æŸ¥è§„åˆ™

AIä½œä¸º"é¦–å¸­é£Žé™©å®˜"ï¼Œæ‰§è¡Œä»¥ä¸‹å®¡æŸ¥ï¼š

1. **è¯„åˆ†ä¸€è‡´æ€§**: Score_B å’Œ Score_C å·®å€¼ä¸èƒ½è¶…è¿‡ 0.5
2. **è½»ä»“å¦å†³**: ä»»ä½• "LIGHT" å»ºè®®ä¸€å¾‹å¦å†³
3. **è¶‹åŠ¿åŒ¹é…**:
   - ä¸Šå‡è¶‹åŠ¿ (Trending_Up) â†’ åªåšå¤š
   - ä¸‹é™è¶‹åŠ¿ (Trending_Down) â†’ åªåšç©º
   - éœ‡è¡å¸‚åœº (Ranging) â†’ åŒå‘
4. **æœ€ç»ˆè¯„åˆ†**: Final_Score å¿…é¡» >= 0.78

## å¸‚åœºçŠ¶æ€åˆ¤æ–­

åŸºäºŽ4å°æ—¶Kçº¿ï¼š
```
if (ADX > 20):
    if (EMA20 > EMA50): Trending_Up
    if (EMA20 < EMA50): Trending_Down
else:
    Ranging
```

## å®žæ–½ç»†èŠ‚

### æ–‡ä»¶ç»“æž„

```
backend/src/controllers/
â”œâ”€â”€ strategy/
â”‚   â””â”€â”€ VolumeProfileStrategy.js  # æˆäº¤é‡ç­–ç•¥æ ¸å¿ƒ
â””â”€â”€ ai/
    â””â”€â”€ AIAnalysis.js              # AIåˆ†æžï¼ˆå·²ä¿®æ”¹ï¼‰
```

### å…³é”®ç±»å’Œæ–¹æ³•

#### VolumeProfileStrategy

```javascript
// å®Œæ•´åˆ†æžæµç¨‹
analyze(symbol, currentPrice)

// æ¨¡å—A: æˆäº¤é‡åˆ†å¸ƒ
calculateVolumeProfile(symbol)

// æ¨¡å—B: æˆäº¤é‡çˆ†å‘
detectVolumeSpike(symbol, volumeProfile, currentKline, previousKlines)

// æ¨¡å—C: å¸‚åœºéªŒè¯
verifyMarketConditions(symbol, direction)

// æ¨¡å—D: èžåˆå†³ç­–
makeFinalDecision(symbol, scoreB, scoreC, direction, currentPrice)
```

#### AIAnalysis (ä¿®æ”¹åŽ)

```javascript
// æ··åˆæ™ºèƒ½åˆ†æž
analyzeWithAI(priceData, priceHistory, signalHistory)

// å¸‚åœºçŠ¶æ€åˆ¤æ–­
determineMarketState(symbol)

// AIé£ŽæŽ§å®¡æŸ¥
performAIRiskReview(reviewPackage)
```

## é…ç½®å¼€å…³

åœ¨ `AIAnalysis.js` ä¸­ï¼š
```javascript
this.useVolumeStrategy = true;  // å¯ç”¨æˆäº¤é‡ç­–ç•¥
```

è®¾ç½®ä¸º `false` å¯å›žé€€åˆ°åŽŸæœ‰çš„ AlphaArena æç¤ºè¯æ¨¡å¼ã€‚

## æ•°æ®è¦æ±‚

1. **Kçº¿æ•°æ®**: 720æ ¹3åˆ†é’ŸKçº¿ï¼ˆ36å°æ—¶ï¼‰
2. **è®¢å•ç°¿**: è‡³å°‘20æ¡£ä¹°å–ç›˜
3. **èµ„é‡‘è´¹çŽ‡**: å®žæ—¶èµ„é‡‘è´¹çŽ‡
4. **æŠ€æœ¯æŒ‡æ ‡**: 
   - 3åˆ†é’Ÿ: EMA20, MACD, RSI, ATR, ADX
   - 4å°æ—¶: EMA20, EMA50, ADX

## æ€§èƒ½è€ƒè™‘

### è®¡ç®—å¤æ‚åº¦
- æ¨¡å—A: O(n) - n=720ï¼Œçº¿æ€§æ‰«æ
- æ¨¡å—B: O(1) - å¸¸æ•°æ—¶é—´æ£€æŸ¥
- æ¨¡å—C: O(1) - APIè°ƒç”¨
- æ¨¡å—D: O(1) - ç®€å•è®¡ç®—

### APIè°ƒç”¨
- æ¯æ¬¡åˆ†æžçº¦5-7ä¸ªAPIè°ƒç”¨
- å»ºè®®åˆ†æžé—´éš”: 3åˆ†é’Ÿï¼ˆä¸ŽKçº¿å‘¨æœŸåŒæ­¥ï¼‰

### ç¼“å­˜ç­–ç•¥
- Kçº¿æ•°æ®: å¯ç¼“å­˜5åˆ†é’Ÿ
- è®¢å•ç°¿: å®žæ—¶èŽ·å–
- èµ„é‡‘è´¹çŽ‡: å¯ç¼“å­˜2åˆ†é’Ÿ

## å›žæµ‹å‡†å¤‡

ä¸ºåŽç»­å›žæµ‹å¼€å‘ï¼Œç­–ç•¥å·²é¢„ç•™ä»¥ä¸‹æŽ¥å£ï¼š

1. **åŽ†å²æ•°æ®å›žæ”¾**: å¯ç”¨åŽ†å²Kçº¿æ•°æ®æ¨¡æ‹Ÿ
2. **å†³ç­–è®°å½•**: æ‰€æœ‰Scoreå’Œå†³ç­–åŽŸå› å·²è®°å½•
3. **æ€§èƒ½æŒ‡æ ‡**: å¯è®¡ç®—èƒœçŽ‡ã€ç›ˆäºæ¯”ã€æœ€å¤§å›žæ’¤

å›žæµ‹æ¨¡å—å»ºè®®ç»“æž„ï¼š
```
backend/src/backtest/
â”œâ”€â”€ BacktestEngine.js      # å›žæµ‹å¼•æ“Ž
â”œâ”€â”€ HistoricalDataLoader.js # åŽ†å²æ•°æ®åŠ è½½
â””â”€â”€ PerformanceMetrics.js   # æ€§èƒ½æŒ‡æ ‡è®¡ç®—
```

## æ—¥å¿—å’Œç›‘æŽ§

ç­–ç•¥è¿è¡Œæ—¶ä¼šè¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼š
```
[æ¨¡å—A] å¼€å§‹è®¡ç®—æˆäº¤é‡åˆ†å¸ƒ...
[æ¨¡å—A] ä¸»å³°ä½ç½®: ç´¢å¼•=450, æˆäº¤é‡=1234.56
[æ¨¡å—A] è®¡ç®—å®Œæˆ: VAH=50123.45, VAL=49876.54, VPOC=50000.00
[æ¨¡å—B] P1é€šè¿‡: ä½äºŽä¸‹è¾¹æ²¿ï¼Œå¾—åˆ†+0.25
[æ¨¡å—B] P2é€šè¿‡: å±€éƒ¨Zå€¼=2.45, å¾—åˆ†+0.20
...
[æ¨¡å—D] âœ… å†³ç­–: STRONG_LONG, ä¿¡å·=BUY, ç½®ä¿¡åº¦=HIGH
ðŸ›¡ï¸ AIé£ŽæŽ§å®¡æŸ¥: BTC/USDT
ðŸ›¡ï¸ AIé£ŽæŽ§å†³ç­–: APPROVE - High scores consistent with ranging market
âœ… BTC/USDT AIæ‰¹å‡†äº¤æ˜“: BUY (ä¿¡å¿ƒ: HIGH)
```

## é£Žé™©æç¤º

1. **å›žæµ‹éªŒè¯**: ç­–ç•¥æœªç»å®žç›˜éªŒè¯ï¼Œå»ºè®®å…ˆè¿›è¡Œå……åˆ†å›žæµ‹
2. **å‚æ•°ä¼˜åŒ–**: å½“å‰å‚æ•°åŸºäºŽç†è®ºè°ƒæ•´ï¼Œå¯èƒ½éœ€è¦æ ¹æ®å®žç›˜æ•°æ®ä¼˜åŒ–
3. **å¸‚åœºé€‚åº”æ€§**: ç­–ç•¥åœ¨ä¸åŒå¸‚åœºçŠ¶æ€ä¸‹è¡¨çŽ°å¯èƒ½å·®å¼‚è¾ƒå¤§
4. **AIä¾èµ–**: é£ŽæŽ§å±‚ä¾èµ–AIæ¨¡åž‹ï¼Œéœ€ç¡®ä¿APIç¨³å®šæ€§

## ä¸‹ä¸€æ­¥è®¡åˆ’

1. âœ… ç­–ç•¥å®žçŽ°å®Œæˆ
2. âœ… AIé›†æˆå®Œæˆ
3. â³ å›žæµ‹ç³»ç»Ÿå¼€å‘
4. â³ å‚æ•°ä¼˜åŒ–
5. â³ å®žç›˜å°é¢æµ‹è¯•
6. â³ æ€§èƒ½ç›‘æŽ§å’ŒæŠ¥å‘Š

## å‚è€ƒæ–‡æ¡£

- `norm_policy.txt` - åŽŸå§‹ç­–ç•¥æ–‡æ¡£
- `binance_websoket_interface.txt` - å¸å®‰APIæ–‡æ¡£
- `CLAUDE.md` - é¡¹ç›®æž¶æž„è¯´æ˜Ž


